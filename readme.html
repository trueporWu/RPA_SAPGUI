<!DOCTYPE html>
<!-- saved from url=(0055)file:///C:/Users/pssotosa/Downloads/Welcome%20file.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome file</title>
  <link rel="stylesheet" href="./readme_files/style.css">
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="sap-rpa-python-v0.1">SAP RPA Python v0.1</h1>
<h4 id="control-de-gestión">Control de Gestión</h4>
<p>El siguiente programa se desarrollo pensando en automatizar los procedimientos manuales recurrentes del Área de Control de Gestión en SAP FI (SAP Logon).</p>
<ul>
<li>Desarrollado en Python</li>
<li>Utilización de funciones SAPGUI</li>
<li>Archivo de Configuración en JSON</li>
</ul>
<div class="mermaid"><svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-kNYcFVezK6P7LlNq" width="100%" style="max-width: 1628.0749969482422px;" viewBox="0 0 1628.0749969482422 243.5867156982422"><g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M137.75,149.86640167236328L162.75,149.86640167236328L187.75,149.86640167236328" marker-end="url(#arrowhead13846)" style="fill:none"></path><defs><marker id="arrowhead13846" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M323.84075573018816,126.86640167236328L389.875,94.91093444824219L414.875,94.91093444824219" marker-end="url(#arrowhead13847)" style="fill:none"></path><defs><marker id="arrowhead13847" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M558.78125,94.91093444824219L583.78125,94.91093444824219L608.78125,94.91093444824219" marker-end="url(#arrowhead13848)" style="fill:none"></path><defs><marker id="arrowhead13848" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M722.7883517608548,84.44027407468502L755.3359375,78.41093444824219L797.4711610006945,85.36165149930574" marker-end="url(#arrowhead13849)" style="fill:none"></path><defs><marker id="arrowhead13849" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M804.7116773955111,112.70073989551096L755.3359375,126.86640167236328L720.3731834773541,114.32292777093659" marker-end="url(#arrowhead13850)" style="fill:none"></path><defs><marker id="arrowhead13850" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M937.2437469482423,95.41093444824219L974.2593688964844,94.91093444824219L1011.7749938964844,94.91093444824219" marker-end="url(#arrowhead13851)" style="fill:none"></path><defs><marker id="arrowhead13851" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M1174.7593688964844,94.91093444824219L1199.7593688964844,94.91093444824219L1255.4844524140144,120.1413166289542" marker-end="url(#arrowhead13852)" style="fill:none"></path><defs><marker id="arrowhead13852" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M1255.4844545218575,180.5914857718577L1199.7593688964844,204.82186889648438L1093.2671813964844,204.82186889648438L974.2593688964844,204.82186889648438L861.8328094482422,204.82186889648438L755.3359375,204.82186889648438L666.265625,204.82186889648438L583.78125,204.82186889648438L486.828125,204.82186889648438L389.875,204.82186889648438L323.84075573018816,172.86640167236328" marker-end="url(#arrowhead13853)" style="fill:none"></path><defs><marker id="arrowhead13853" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M1420.6999923706055,150.36640167236328L1457.7156219482422,149.86640167236328L1495.2312469482422,149.86640167236328" marker-end="url(#arrowhead13854)" style="fill:none"></path><defs><marker id="arrowhead13854" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(755.3359375,126.86640167236328)" style="opacity: 1;"><g transform="translate(-6.5859375,-13)" class="label"><foreignobject width="13.171875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">SI</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(974.2593688964844,94.91093444824219)" style="opacity: 1;"><g transform="translate(-12.515625,-13)" class="label"><foreignobject width="25.03125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">NO</span></div></foreignobject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(755.3359375,204.82186889648438)" style="opacity: 1;"><g transform="translate(-6.5859375,-13)" class="label"><foreignobject width="13.171875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">SI</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(1457.7156219482422,149.86640167236328)" style="opacity: 1;"><g transform="translate(-12.515625,-13)" class="label"><foreignobject width="25.03125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">NO</span></div></foreignobject></g></g></g><g class="nodes"><g class="node" id="A" transform="translate(78.875,149.86640167236328)" style="opacity: 1;"><rect rx="0" ry="0" x="-58.875" y="-23" width="117.75" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48.875,-13)"><foreignobject width="97.75" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Inicio Proceso</div></foreignobject></g></g></g><g class="node" id="A2" transform="translate(276.3125,149.86640167236328)" style="opacity: 1;"><rect rx="0" ry="0" x="-88.5625" y="-23" width="177.125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.5625,-13)"><foreignobject width="157.125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Identificar Transaccion</div></foreignobject></g></g></g><g class="node" id="B" transform="translate(486.828125,94.91093444824219)" style="opacity: 1;"><rect rx="0" ry="0" x="-71.953125" y="-23" width="143.90625" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-61.953125,-13)"><foreignobject width="123.90625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Inicio Transaccion</div></foreignobject></g></g></g><g class="node" id="C" transform="translate(666.265625,94.91093444824219)" style="opacity: 1;"><circle x="-57.484375" y="-23" r="57.484375"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-47.484375,-13)"><foreignobject width="94.96875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Ejecutar Paso</div></foreignobject></g></g></g><g class="node" id="D" transform="translate(861.8328094482422,94.91093444824219)" style="opacity: 1;"><polygon points="74.9109375,0 149.821875,-74.9109375 74.9109375,-149.821875 0,-74.9109375" rx="5" ry="5" transform="translate(-74.9109375,74.9109375)"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-50.234375,-13)"><foreignobject width="100.46875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Siguiente Step</div></foreignobject></g></g></g><g class="node" id="E" transform="translate(1093.2671813964844,94.91093444824219)" style="opacity: 1;"><rect rx="0" ry="0" x="-81.4921875" y="-23" width="162.984375" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-71.4921875,-13)"><foreignobject width="142.984375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Termino Transaccion</div></foreignobject></g></g></g><g class="node" id="F" transform="translate(1322.4796829223633,149.86640167236328)" style="opacity: 1;"><polygon points="97.7203125,0 195.440625,-97.7203125 97.7203125,-195.440625 0,-97.7203125" rx="5" ry="5" transform="translate(-97.7203125,97.7203125)"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-75.578125,-13)"><foreignobject width="151.15625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Siguiente Transaccion</div></foreignobject></g></g></g><g class="node" id="G" transform="translate(1563.6531219482422,149.86640167236328)" style="opacity: 1;"><rect rx="0" ry="0" x="-68.421875" y="-23" width="136.84375" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-58.421875,-13)"><foreignobject width="116.84375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Termino Proceso</div></foreignobject></g></g></g></g></g></g></svg></div>
<h4 id="archivo-de-configuración">Archivo de Configuración</h4>
<p>El archivo de configuración se utiliza para decirle especificarle los pasos y las acciones que debe ejecutar el programa en</p>
<p>Estructura del Archivo</p>
<pre class=" language-json"><code class="prism  language-json"><span class="token punctuation">{</span>
    <span class="token string">"saplogonpath"</span><span class="token punctuation">:</span> <span class="token string">"C:\\Program Files (x86)\\SAP\\FrontEnd\\SAPgui\\saplogon.exe"</span><span class="token punctuation">,</span>
    <span class="token string">"conectionName"</span><span class="token punctuation">:</span> <span class="token string">"EP0 (Produccion ERP LatAm)"</span><span class="token punctuation">,</span>
    <span class="token string">"username"</span> <span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string">"password"</span> <span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string">"transactions_execute"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
    		<span class="token string">"transaction_code"</span><span class="token punctuation">:</span><span class="token string">"ZCO_0137"</span><span class="token punctuation">,</span>
    	    <span class="token string">"executions_steps"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    	             <span class="token punctuation">{</span> <span class="token string">"step_id"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    				   <span class="token string">"comment"</span><span class="token punctuation">:</span><span class="token string">"Sociedad (0404,0077)"</span><span class="token punctuation">,</span>
    	               <span class="token string">"type_find"</span><span class="token punctuation">:</span><span class="token string">"id"</span><span class="token punctuation">,</span>
	    	           <span class="token string">"cod_find"</span><span class="token punctuation">:</span><span class="token string">"wnd[0]/usr/ctxtPA_KOKRS"</span><span class="token punctuation">,</span>
    	               <span class="token string">"action"</span><span class="token punctuation">:</span><span class="token string">"text"</span><span class="token punctuation">,</span>
    				   <span class="token string">"value_type"</span><span class="token punctuation">:</span><span class="token string">"input"</span>
    	             <span class="token punctuation">}</span><span class="token punctuation">,</span>
    	             <span class="token punctuation">{</span> <span class="token string">"step_id"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    	               <span class="token string">"comment"</span><span class="token punctuation">:</span><span class="token string">"Accion Ejecutar"</span><span class="token punctuation">,</span>
    	               <span class="token string">"type_find"</span><span class="token punctuation">:</span><span class="token string">"id"</span><span class="token punctuation">,</span>
    	               <span class="token string">"cod_find"</span><span class="token punctuation">:</span><span class="token string">"wnd[0]/tbar[1]/btn[8]"</span><span class="token punctuation">,</span>
    	               <span class="token string">"action"</span><span class="token punctuation">:</span><span class="token string">"press"</span><span class="token punctuation">,</span>
    				   <span class="token string">"value_type"</span><span class="token punctuation">:</span><span class="token string">"na"</span>
    	             <span class="token punctuation">}</span><span class="token punctuation">,</span>
    	             <span class="token punctuation">{</span> <span class="token string">"step_id"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span>
    	               <span class="token string">"comment"</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">,</span>
    	               <span class="token string">"type_find"</span><span class="token punctuation">:</span><span class="token string">"id"</span><span class="token punctuation">,</span>
    	               <span class="token string">"cod_find"</span><span class="token punctuation">:</span><span class="token string">"wnd[0]/usr/cntlGV_CONTAINER_ALV_DETALLE/shellcont/shell"</span><span class="token punctuation">,</span>
    	               <span class="token string">"action"</span><span class="token punctuation">:</span><span class="token string">"pressToolbarContextButton"</span><span class="token punctuation">,</span>
    				   <span class="token string">"value_type"</span><span class="token punctuation">:</span><span class="token string">"fixed"</span><span class="token punctuation">,</span>
    				   <span class="token string">"value"</span><span class="token punctuation">:</span> <span class="token string">"&amp;MB_EXPORT"</span>
    	             <span class="token punctuation">}</span>
    	 <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>

<table>
<thead>
<tr>
<th>Item</th>
<th>Valor</th>
<th>Comentario</th>
</tr>
</thead>
<tbody>
<tr>
<td>“saplogonpath”</td>
<td>Ruta de Saplogon.exe</td>
<td>Esta se debe cambiar en caso de estar instalado SAP Logon en otra ubicación</td>
</tr>
<tr>
<td>“connectionName”</td>
<td>Nombre de la Conexión del SAP</td>
<td>Estos son los nombres de conexiones que están en SAP Logon</td>
</tr>
<tr>
<td>“username”</td>
<td>Usuario Conexión</td>
<td>Si esta en blanco el programa pedirá su ingreso</td>
</tr>
<tr>
<td>“password”</td>
<td>Password del usuario</td>
<td>Si esta en blanco el programa pedirá su ingreso</td>
</tr>
<tr>
<td>“transaction_code”</td>
<td>Código de Transacción</td>
<td>Código SAP de Transaccion necesario para abrir/ejecutar transacción mediante SAP Logon</td>
</tr>
<tr>
<td>“comment”</td>
<td>Comentario</td>
<td>Este aparecerá en consola para dar seguimiento al flujo</td>
</tr>
<tr>
<td>“type_find”</td>
<td>Tipo de Búsqueda de Objeto</td>
<td>Validos:<code>[id]</code></td>
</tr>
<tr>
<td>“cod_find”</td>
<td>Código de Objeto</td>
<td>Codigo del objeto a encontrar para ejecutar la acción sobre el</td>
</tr>
<tr>
<td>“action”</td>
<td>Accion a ejecutar sobre Objeto Encontrado</td>
<td>Validos: <code>[select, pressToolbarContextButton, selectContextMenuItem, key, press, text]</code></td>
</tr>
<tr>
<td>“value_type”</td>
<td>Tipo de Valor a ingresas</td>
<td>Validos: <code>[input, fixed, na]</code> En caso de input el programa pedira el valor por consola, en caso de fixed tomara el valor del json</td>
</tr>
<tr>
<td>“value”</td>
<td>Valor a ingresar al objeto</td>
<td>Aplica para acciones: <code>[selectContextMenuItem, key, text]</code></td>
</tr>
</tbody>
</table><blockquote>
<p><strong>Nota</strong> para obtener el Id de los objetos de SAP Logon se puede utilizar la aplicación <a href="https://tracker.stschnell.de/">Scripting Tracket</a></p>
</blockquote>
</div>



</body></html>